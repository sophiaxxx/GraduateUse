<!doctype html>
<html>
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script type="text/javascript" src="./web/js/release/jquery.fullscreen.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script> 

    <style type="text/css">
    @import url(https://fonts.googleapis.com/earlyaccess/notosanstc.css);
      * {
          font-family: 'Noto Sans TC';
      }
      @-moz-keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* Firefox */
      @-webkit-keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* Webkit */
      @-ms-keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* IE */
      @keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* Opera and prob css3 final iteration */
      #alertImg, #alertImg2 {
        position:absolute;
      　top:10px;
      　left:10px;
      　width:50px;
      　height:50px;
      　z-index:1;
        -moz-transition:all 1s ease-in-out;
        -webkit-transition:all 1s ease-in-out;
        -o-transition:all 1s ease-in-out;
        -ms-transition:all 1s ease-in-out;
        transition:all 1s ease-in-out;
        -moz-animation:blink normal 2s infinite ease-in-out; 
        -webkit-animation:blink normal 2s infinite ease-in-out; 
        -ms-animation:blink normal 2s infinite ease-in-out; 
        animation:blink normal 2s infinite ease-in-out; 
      }​

      /*header height*/
      #hhh{
        height:350px;
        background-color:#91C5E9;
      }
      /*header img height*/
      .rounded{
        height:50px;
      }
      /*#marqueebg{
        background-color:#91C5E9;
      }*/
      #kkk{
        background-color:#91C5E9;
      }
      .mr-3{
        height:350px;
        width: 500px;
        color: #696969;
        text-align:justify;
        font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
      }
      /*右邊新聞*/
      h1{
        font-weight:bolder;
      }
      /*#username{
        color: #FFFFFF;
      }*/
      /*carousel height*/
      .carouselrow{
        height:1450px;
      }
      /*carousel img*/
      .img-responsive{
        height:1450px;
      }

      #footer{
        padding-top:30px;
        background-color:#20CACB;
        /*height:300px;*/
      }
      /*#fullscreen{
        background-color:#F9F9F8;
      }*/
      .news_title{
        font-size: 200%;
      }
      .list-unstyled{
        padding-right:30px;
      }
      button {
        background: transparent;
        border: none !important;
      }​
      .media{
        /*padding-bottom:px;*/
      }
      .card h1{
        font-size: 50px;
      }
      .card h2{
        font-size: 80px;
      }
      .card h3{
        font-size: 40px;
      }
      .card h4{
        font-size: 30px;
      }
      #bookmsg ul.imageStyle {
        font-size: 50px;
        list-style-image:url('./images/li-book.png');
      }
      #ActivityMsg ul.imageStyle {
        font-size: 50px;
        list-style-image:url('./images/li-cherryblossom.png');
      }
      #ClassMsg ul.imageStyle {
        font-size: 50px;
        list-style-image:url('./images/li-sprout.png');
      }
      #LectureMsg ul.imageStyle {
        list-style-image:url('./images/li-tree.png');
      }
    </style>
    <title>Hello</title>
  </head>
  <body>
    <div id="fullscreen">
        <div class="row" style="height: 400px" id="kkk">
          <marquee style="height: 50px" id="marqueebg">
          
          </marquee>
          <marquee direction="right" scrollamount="10" behavior="alternate" id="marqueebg">
            <h1>
              <big><big><big><big><big><big><big>
                <big id="username" data-id="" data-name="" data-isMember="">歡迎光臨國立暨南國際大學</big>
              </big></big></big></big></big></big></big>
            </h1>
          </marquee>
          <div class="col" align="right">
            <button id="btn-Exit" type="button" class="btn btn-default">
              離開
            </button>
          </div>
        </div>


      
    
      <div class="row carouselrow" >
        <div class="col-xs-12 col-sm-6" id="carouselrow">
            <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
              <ol class="carousel-indicators">
                <li data-target="#carouselExampleCaptions" data-slide-to="0" class=""></li>
                <li data-target="#carouselExampleCaptions" data-slide-to="1" class=""></li>
                <li data-target="#carouselExampleCaptions" data-slide-to="2" class=""></li>
                <li data-target="#carouselExampleCaptions" data-slide-to="3" class="active"></li>
              </ol>
              <div class="carousel-inner">
                <div class="carousel-item">
                  <img class="img-responsive w-100" alt="First slide" src="/images/c0427.jpg" data-holder-rendered="true">
                  <div class="carousel-caption d-none d-md-block">
                    <h1>歡迎成為暨大人!</h1>
                    <h4>107學年度大學個人申請入學招生於107年4月26日放榜。</h4>
                  </div>
                </div>
                <div class="carousel-item">
                  <img class="img-responsive w-100" alt="Second slide" src="/images/c0523.jpg" data-holder-rendered="true">
                  <div class="carousel-caption d-none d-md-block">
                    <h1>中興新村風華再現共識論壇 </h1>
                    <h4>暨大邀集相關部會人員、里長、在地長輩、居民等，共同討論和激盪，為中興新村的可行之路，勾勒出具體可行的共識。</h4>
                  </div>
                </div>
                <div class="carousel-item">
                  <img class="img-responsive w-100" alt="Third slide" src="/images/c0316.jpg" data-holder-rendered="true">
                  <div class="carousel-caption d-none d-md-block">
                    <h1>漫步春季 青春印「暨」</h1>
                    <h4>國立暨南國際大學春季健走活動於本月15日下午開跑。</h4>
                  </div>
                </div>
                <div class="carousel-item active">
                  <img class="img-responsive w-100" alt="Four slide" src="/images/c0227.jpg" data-holder-rendered="true">
                  <div class="carousel-caption d-none d-md-block">
                    <h1>暨大社會責任實踐深受肯定  全台唯一四案全數通過的一般大學</h1>
                    <h4>企盼藉由本次高教深耕計畫，積極建構大學社會責任的支持系統，培育出多元優質人才，提升國家整體競爭力!</h4>
                  </div>
                </div>
              </div>
              <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6">
          <ul class="list-unstyled" id="news">
            <li class="media">
              <img class="mr-3" src="/images/N0629.jpg" alt="Generic placeholder image">
              <div class="media-body">
                <h2 class="mt-0 mb-1">微型提案「可可」趣 自主學習經驗寶</h2>
                <h3>為鼓勵暨大同學與在地居民自主性參與社區公共議題，暨大通識中心鼓勵同學自組團隊，關懷在地議題，透過團隊合作之互動與共學化為具體行動，培養公共事務自主學習及參與的知識力與動力，將多元的觀點、專長、創意與熱情轉化為實際行動，協助在地活化及永續性發展。</h3>
              </div>
            </li>
            <li class="media my-1">
              <img class="mr-3" src="/images/N0702.jpg" alt="Generic placeholder image">
              <div class="media-body">
                <h2 class="mt-0 mb-1">微型提案「可可」趣 自主學習經驗寶</h2>
                <h3>為鼓勵暨大同學與在地居民自主性參與社區公共議題，暨大通識中心鼓勵同學自組團隊，關懷在地議題，透過團隊合作之互動與共學化為具體行動，培養公共事務自主學習及參與的知識力與動力，將多元的觀點、專長、創意與熱情轉化為實際行動，協助在地活化及永續性發展。</h3>
              </div>
            </li>
            <li class="media my-1">
              <img class="mr-3" src="/images/N0703.jpg" alt="Generic placeholder image">
              <div class="media-body">
                <h2 class="mt-0 mb-1">微型提案「可可」趣 自主學習經驗寶</h2>
                <h3>為鼓勵暨大同學與在地居民自主性參與社區公共議題，暨大通識中心鼓勵同學自組團隊，關懷在地議題，透過團隊合作之互動與共學化為具體行動，培養公共事務自主學習及參與的知識力與動力，將多元的觀點、專長、創意與熱情轉化為實際行動，協助在地活化及永續性發展。</h3>
              </div>
            </li>
            <li class="media my-1">
              <img class="mr-3" src="/images/N0623.jpg" alt="Generic placeholder image">
              <div class="media-body">
                <h2 class="mt-0 mb-1">微型提案「可可」趣 自主學習經驗寶</h2>
                <h3>為鼓勵暨大同學與在地居民自主性參與社區公共議題，暨大通識中心鼓勵同學自組團隊，關懷在地議題，透過團隊合作之互動與共學化為具體行動，培養公共事務自主學習及參與的知識力與動力，將多元的觀點、專長、創意與熱情轉化為實際行動，協助在地活化及永續性發展。</h3>
              </div>
            </li>
          </ul>
        </div>
      </div>
      
      <div class="row" id="footer">
        <div class="col-lg-2"  align="center">
          <button id="btn-newsMsg" type="button"><img src="./images/001-news.png" alt="Generic placeholder image" width="200" height="200"></button>
          <h2>最新消息</h2>
        </div>
        <div class="col-lg-2"  align="center">
          <img id="alertImg" src="./images/alert.png" alt="Alert image" style="visibility: hidden;">
          <button id="btn-bookMsg" type="button"><img src="./images/006-books.png" alt="Generic placeholder image" width="200" height="200"></button>
          <h2>借閱資訊</h2>
        </div>
        <div class="col-lg-2"  align="center">
          <button id="btn-mapChange" type="button"><img src="./images/007-school.png" alt="Generic placeholder image" width="200" height="200"></button>
          <h2>校園地圖</h2>
        </div>
        <div class="col-lg-2"  align="center">
          <button id="btn-ActivityMsg" type="button"><img src="./images/002-activities.png" alt="Generic placeholder image" width="200" height="200"></button>
          <h2>活動訊息</h2>
        </div>
        <div class="col-lg-2"  align="center">
          <img id="alertImg2" src="./images/alert.png" alt="Alert image" 
               style="visibility: hidden;">
          <button id="btn-ClassMsg" type="button"><img src="./images/005-blackboard.png" alt="Generic placeholder image" width="200" height="200"></button>
          <h2>課程訊息</h2>
        </div>
        <div class="col-lg-2"  align="center">
          <button id="btn-LectureMsg"  type="button"><img src="./images/004-speaker.png" alt="Generic placeholder image" width="200" height="200"></button>
          <h2>講座分享</h2>
        </div>
      </div>
      <img src="./images/ncnu_logo.svg" alt="國立暨南國際大學" align="center" 
             class="rounded mx-auto d-block"> 
    </div>

    <script src="./web/js/index.js"></script>
    <script src="../socket.io/socket.io.js"></script>
    <script>
    $(function () {
      var socket = io();
      socket.on('Update User', function(stockprice) {
        _handleUserGet();
      });

      function _handleUserGet() {
        $.ajax({
          url: '/user',
          type: 'get',
          dataType: 'json',
          contentType: 'application/json',
          xhrFields: {
            withCredentials: true
          },
          success: function (data) {

            if($('#username').attr("data-name") != data.name){
              $('#username').html(`歡迎光臨  ${data.name}  蒞臨暨大`);
              $('#username').attr('data-name', data.name);
              $('#username').attr('data-id', data.id);
              $('#username').attr('data-isMember', data.isMember);

              var img = document.getElementById('alertImg');
              var img2 = document.getElementById('alertImg2');
              if($('#username').attr("data-name") == "朱育柔"){
                img.style.visibility = "visible";
                img2.style.visibility = "visible";
              }
              else{
                img.style.visibility = "hidden";
                img2.style.visibility = "hidden";
              }

              if(data.gender == "female")
              {
                if(data.age > 30){
                $('#footer').css("background-color", "#F46F5E");
                $('#kkk').css("background-color", "#F89284");
              }
              else{
                $('#footer').css("background-color", "#FFC9C8");
                $('#kkk').css("background-color", "#B1DCE8");
              }
            }
            else{
              if(data.age > 30){
                $('#footer').css("background-color", "#0396A6");
                $('#kkk').css("background-color", "#71DDE3");
              }
              else{
                $('#footer').css("background-color", "#20CACB");
                $('#kkk').css("background-color", "#91C5E9");
              }
            }
            _newsGet();
            }
          },
          error: function (jqXHR, statusCode, c) {
            console.log(jqXHR);
          }
        });
      }

      function _newsGet(){
        $.ajax({
          url: '/news',
          type: 'get',
          dataType: 'json',
          contentType: 'application/json',
          xhrFields: {
            withCredentials: true
          },
          success: function (data) {
            console.log("/news");
            $('#news').html('');

            if($('#username').attr("data-isMember") == "true" 
                      || $('#username').attr("data-name") =="朱育柔"){
              PersonNews = data.filter(function(el) {
                return el.IsNCNU !== "N";
              });
            }
            else
            {
              PersonNews = data.filter(function(el) {
                return el.IsNCNU !== "Y";
              });
            }

            console.log(PersonNews);
            var count = 0;
            for (let news of PersonNews) {
              if(count < 4){
                news.title = news.title || '';
                news.content = news.content || '';
                news.PostDate = news.PostDate || '';
                news.image = news.image || '';

                $('#news').prepend(`
                  <li class="media my-1">
                    <img class="mr-3" src="${news.image}" alt="Generic placeholder image">
                    <div class="media-body">
                      <h1 class="mt-0 mb-1">${news.title}</h1>
                      <h2>${news.content}</h2>
                      <h4>${news.PostDate}</h4>
                    </div>
                  </li>`
                  );
                count += 1;
              }
            }
          },
          error: function (jqXHR, statusCode, c) {
            console.log(jqXHR);
          }
        });
      }
    });      
    </script> 
  </body>
</html>